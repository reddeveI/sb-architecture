#### 1. Выбрать и обосновать тип базы данных (реляционная, документоориентированная, «ключ — значение») для каждого сервиса. 

- Для сервисов пользователей и заказов выбираем, так как нам требуется надежная обработка транзакций и ссылочная целостность
- Для сервиов доставки и продуктов выбираем нереляционные базы, для этого были закуплены дополнительные мощности в разных регионах страны и сервисы и хранилища данных будут расположены близко что позволит сократить задержку (latency)

![alt tag](https://github.com/reddeveI/sb-architecture/blob/main/images/Data-storage-latest.jpg)

<hr />

#### 2. Определить и записать ключевые модели данных для каждого сервиса. Необходимо решить, в каком виде вы будете хранить данные для каждого сервиса, и качественно оценить ожидаемый прирост данных на основе выделенных моделей для месячного и квартального периода.

- Сервис пользователей: профиль пользователя
- Сервис заказов: Информация о заказе и список товаров
- Сервис доставки: Информация о доставке
- Сервис продуктов: Информация о товаре

#### Профиль пользователя
|Поле|Тип|Размер записи|
|----------------|-------------|--------------------------|
|Id|Число|4 байта|
|Логин|Строка|1200 байт|
|ФИО|Строка|1200 байт|
|Регион|Строка|1200 байт|
|Пол|Строка|1200 байт|
|Дата рождения|Строка|1200 байт|

#### Заказы
|Поле|Тип|Размер записи|
|----------------|-------------|--------------------------|
|Id|Число|4 байта|
|Название товара|Строка|1200 байт|
|Статус заказа|Число|4 байта|

#### Доставка
|Поле|Тип|Размер записи|
|----------------|-------------|--------------------------|
|Id|Число|4 байта|
|Трек-номер|Строка|1200 байт|
|Служба доставки|Строка|1200 байт|

#### Товары
|Поле|Тип|Размер записи|
|----------------|-------------|--------------------------|
|Id|Число|4 байта|
|Название товара|Строка|1200 байт|
|Код|Число|4 байта|
|Склад и раположение|Строка|1200 байт|
|Количество|Число|4 байта|

#### Оценка роста данных
|Тип|Назначение|Рост в месяц|Рост в квартал|
|----------------|-------------|--------------------------|--------|
|Товар|Характеристики производимой продукции|В среднем 0|5000 × 2.5 Кб характеристики + изображения до 10 Мб|
|Клиент|	Учётная запись клиента|2000 × 5 Кб = 10000 Кб|30000 Кб ± 3000 Кб|
|Заказы|	Управление заказами|5000 × 1 Кб = 5000 Кб|15000 Кб ± 1500 Кб|
|Доставка|	Информация о службах доставки|5000 × 2 Кб = 10000 Кб|30000 Кб ± 300 Кб|
|**Итого**|	|**~25 Мб**|**~80 Мб**|

<hr />

#### 3. Клиент делает заказ на 20 штук, но на одном складе нужного количества нет. Как собрать заказ так, чтобы в процессе всё было согласованно, мы могли ответить клиенту, что всё в наличии, и в процессе этой операции кто-то другой не выкупил бы товар на одном из складов? Как вы будете решать такую задачу? Опишите и обоснуйте стратегию решения. Какие риски и последствия вы видите? 

![alt tag](https://github.com/reddeveI/sb-architecture/blob/main/images/Transactions-swimlane.jpg)

<hr />

#### 4. Всё то же самое, что и в предыдущем вопросе, но теперь на складе 3 всего две единицы товара А. Как вы будете решать такую задачу? Опишите и обоснуйте стратегию решения. Какие риски и последствия вы видите?

Риски и последствия:
Если транзакция полностью не отменится, то товары будут стоять в статусе на отгрузку и будут недоступны для покупки, хотя заявка с этими товарами уже была отменена

![alt tag](https://github.com/reddeveI/sb-architecture/blob/main/images/Transaction-swimlane-cancelling.jpg)

<hr />

#### 5. Если у нас несколько сайтов-витрин, которые показывают каталог продуктов с ценами, то как будет происходить синхронизация цен на них? Как мы можем быть уверены, что цена на товар при её изменении администратором корректно отображается на всех сайтах-витринах? Ведь клиент может попасть на любой из сервисов, и будет нехорошо, если при обновлении страницы клиент будет попадать то на один сервис, то на другой и цена будет различаться, потому что синхронизация данных запаздывает.

- Предлагается кэшировать цену товара в редисе, и каждый раз при обновлении цены товара администратором, обновлять данные в редисе

![alt tag](https://github.com/reddeveI/sb-architecture/blob/main/images/Synchronization-latency-problem.jpg)

<hr />

#### 6. Как разрешать такие ситуации? Если клиент кладёт товар со скидкой, то он 100% должен заплатить указанную цену, при этом фирма не должна потерять деньги на доставке с другого отдалённого склада. Представьте решение и обоснование

- Необходимо вычислять скидку в процессе оформления товара
Допустим пользователь приобретает товар в регионе Склада 1

Склад 1 — 10 штук. Скидка - 10%
Склад 2 — 5 штук. Скидка - 0%
Склад 3 — 8 штук. Скидка - 0%

Итого пользователь получает общую скидку на заказ в размере 5%
